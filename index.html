<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>æ…ˆé›²å±±å¤©ä¸»æ•™å°å­¸æ°´ç«ç®­æ¨¡æ“¬å™¨</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        body { font-family: 'PingFang TC', 'Microsoft JhengHei', sans-serif; touch-action: manipulation; }
        .slider-thumb::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 24px;
            height: 24px;
            background: #3B82F6;
            cursor: pointer;
            border-radius: 50%;
            border: 2px solid white;
            box-shadow: 0 0 5px rgba(0,0,0,0.2);
        }
        #simCanvas { 
            background: linear-gradient(to bottom, #bae6fd 0%, #f0f9ff 100%); 
            cursor: crosshair;
        }
        .highlight-change { background-color: #fef08a !important; border: 2px solid #eab308; }
        /* Match heights */
        .sync-height { height: 620px; }
        @media (max-width: 1024px) { .sync-height { height: auto; } }
    </style>
</head>
<body class="bg-slate-100 pb-20">

    <header class="bg-blue-600 text-white p-4 shadow-md text-center">
        <h1 class="text-2xl font-bold decoration-orange-400">ğŸš€ æ…ˆé›²å±±å¤©ä¸»æ•™å°å­¸æ°´ç«ç®­å¯¦é©—å®¤</h1>
    </header>

    <main class="max-w-7xl mx-auto p-4 grid grid-cols-1 lg:grid-cols-12 gap-6">
        
        <section class="lg:col-span-4 bg-white p-6 rounded-2xl shadow-xl border-t-8 border-blue-500 flex flex-col justify-between sync-height">
            <h2 class="text-xl font-bold mb-4 flex items-center border-b pb-2">âš™ï¸ å¯¦é©—è¨­å®š(å…±5é …ï¼Œå¯å‘ä¸‹æ‹‰ï¼‰</h2>
            
            <div class="space-y-5 flex-grow overflow-y-auto pr-2">
                <div class="bg-blue-50 p-3 rounded-xl">
                    <div class="flex justify-between items-center mb-1">
                        <label class="font-bold text-blue-800">1. æ°´é‡ (ml / %)</label>
                        <button onclick="showInfo('water')" class="bg-blue-500 text-white w-5 h-5 rounded-full text-xs">?</button>
                    </div>
                    <div class="flex gap-3 items-center">
                        <input type="range" id="waterSlide" min="0" max="500" value="250" class="flex-grow h-2 bg-blue-200 rounded-lg appearance-none slider-thumb">
                        <input type="number" id="waterInput" value="250" class="w-16 border-2 border-blue-200 rounded text-center font-bold">
                    </div>
                    <p class="text-xs text-blue-600 mt-1">ç›®å‰ä½”æ¯”: <span id="waterPct">50</span>%</p>
                </div>

                <div class="bg-orange-50 p-3 rounded-xl">
                    <div class="flex justify-between items-center mb-1">
                        <label class="font-bold text-orange-800">2. æ©Ÿèº«é‡é‡ (g)</label>
                        <button onclick="showInfo('mass')" class="bg-orange-500 text-white w-5 h-5 rounded-full text-xs">?</button>
                    </div>
                    <div class="flex gap-3 items-center">
                        <input type="range" id="massSlide" min="100" max="500" value="200" class="flex-grow h-2 bg-orange-200 rounded-lg appearance-none slider-thumb">
                        <input type="number" id="massInput" value="200" class="w-16 border-2 border-orange-200 rounded text-center font-bold">
                    </div>
                </div>

                <div class="bg-green-50 p-3 rounded-xl">
                    <div class="flex justify-between items-center mb-1">
                        <label class="font-bold text-green-800">3. æ°£å£“ (psi)</label>
                        <button onclick="showInfo('pressure')" class="bg-green-500 text-white w-5 h-5 rounded-full text-xs">?</button>
                    </div>
                    <div class="flex gap-3 items-center">
                        <input type="range" id="pressureSlide" min="0" max="60" step="5" value="40" class="flex-grow h-2 bg-green-200 rounded-lg appearance-none slider-thumb">
                        <input type="number" id="pressureInput" value="40" class="w-16 border-2 border-green-200 rounded text-center font-bold">
                    </div>
                </div>

                <div class="bg-purple-50 p-3 rounded-xl">
                    <div class="flex justify-between items-center mb-1">
                        <label class="font-bold text-purple-800">4. ç™¼å°„è§’åº¦ (Â°)</label>
                        <button onclick="showInfo('angle')" class="bg-purple-500 text-white w-5 h-5 rounded-full text-xs">?</button>
                    </div>
                    <div class="flex gap-3 items-center">
                        <input type="range" id="angleSlide" min="0" max="90" step="5" value="45" class="flex-grow h-2 bg-purple-200 rounded-lg appearance-none slider-thumb">
                        <input type="number" id="angleInput" value="45" class="w-16 border-2 border-purple-200 rounded text-center font-bold">
                    </div>
                </div>

                <div class="bg-slate-50 p-3 rounded-xl">
                    <div class="flex justify-between items-center mb-1">
                        <label class="font-bold text-slate-800">5. å°¾ç¿¼å½¢ç‹€</label>
                        <button onclick="showInfo('fins')" class="bg-slate-500 text-white w-5 h-5 rounded-full text-xs">?</button>
                    </div>
                    <select id="finShape" class="w-full p-2 border-2 border-slate-200 rounded-lg font-bold">
                        <option value="1.0">ä¸‰è§’å½¢ç¿¼</option>
                        <option value="1.3">æ–¹å½¢ç¿¼</option>
                        <option value="0.9">æ¢¯å½¢ç¿¼</option>
                        <option value="1.1">åœ“å½¢ç¿¼</option>
                        <option value="0.8">é­šé°­ç¿¼</option>
                        <option value="0.7">å¾Œæ ç¿¼</option>
                    </select>
                </div>
            </div>

            <button id="launchBtn" class="mt-4 w-full bg-red-500 hover:bg-red-600 active:scale-95 text-white font-black py-4 rounded-2xl text-2xl shadow-lg transition-all border-b-4 border-red-800">
                ğŸš€ ç™¼å°„é å‚™ï¼
            </button>
        </section>

        <section class="lg:col-span-8 flex flex-col gap-4 sync-height">
            <div class="relative flex-grow bg-white p-2 rounded-2xl shadow-xl overflow-hidden border-4 border-white">
                <canvas id="simCanvas" class="w-full h-full rounded-xl"></canvas>
                
                <div class="absolute top-4 left-4 right-4 flex justify-between">
                    <div class="flex gap-2">
                        <div class="bg-white/90 px-4 py-2 rounded-full shadow-sm border border-blue-200 font-bold text-blue-600">
                            é«˜åº¦: <span id="hudHeight">0.0</span> m
                        </div>
                        <div class="bg-white/90 px-4 py-2 rounded-full shadow-sm border border-blue-200 font-bold text-blue-600">
                            è·é›¢: <span id="hudDist">0.0</span> m
                        </div>
                    </div>
                    <div id="statusTag" class="hidden bg-orange-500 text-white px-4 py-2 rounded-full font-bold animate-pulse">
                        é£›è¡Œä¸­...
                    </div>
                </div>
            </div>

            <div id="fairTestBox" class="hidden bg-amber-100 border-l-8 border-amber-500 p-4 rounded-xl text-amber-900 shadow-md">
                <p class="font-black text-lg">ğŸ’¡ å°ç§‘å­¸å®¶ç­†è¨˜ï¼š</p>
                <p>ç‚ºäº†å…¬å¹³æ¸¬è©¦ï¼Œæ¯æ¬¡å¯¦é©—è«‹<b>åªæ”¹è®Šä¸€å€‹æ•¸å€¼</b>ï¼Œæ‰èƒ½æ‰¾å‡ºçœŸæ­£çš„é—œéµå› ç´ å–”ï¼</p>
            </div>
        </section>

        <section class="lg:col-span-12 bg-white p-6 rounded-2xl shadow-xl">
            <div class="flex flex-col md:flex-row justify-between items-center mb-6 gap-4">
                <h2 class="text-2xl font-black text-gray-800">ğŸ“Š é£›è¡Œç´€éŒ„æ•¸æ“šè¡¨</h2>
                <div class="flex flex-wrap gap-2">
                    <!-- <button onclick="copyTableData()" class="bg-emerald-500 hover:bg-emerald-600 text-white px-5 py-2 rounded-xl font-bold shadow-md">ğŸ“‹ è¤‡è£½æ•¸æ“š</button> -->
                    <button onclick="exportTableImage()" class="bg-indigo-500 hover:bg-indigo-600 text-white px-5 py-2 rounded-xl font-bold shadow-md">ğŸ–¼ï¸ åŒ¯å‡ºåœ–ç‰‡</button>
                    <button onclick="clearHistory()" class="bg-rose-500 hover:bg-rose-600 text-white px-5 py-2 rounded-xl font-bold shadow-md">ğŸ—‘ï¸ æ¸…ç©ºæ‰€æœ‰</button>
                </div>
            </div>
            <div class="overflow-x-auto">
                <table id="recordTable" class="w-full text-center border-separate border-spacing-y-2">
                    <thead>
                        <tr class="text-gray-500 uppercase text-sm font-bold">
                            <th class="pb-2">æ¸¬è©¦æ¬¡æ•¸</th>
                            <th class="pb-2">æ°´é‡(ml)</th>
                            <th class="pb-2">é‡é‡(g)</th>
                            <th class="pb-2">æ°£å£“(psi)</th>
                            <th class="pb-2">å°¾ç¿¼å½¢ç‹€</th>
                            <th class="pb-2">è§’åº¦</th>
                            <th class="pb-2 text-red-500">ç¸½è·é›¢(m)</th>
                        </tr>
                    </thead>
                    <tbody id="tableBody"></tbody>
                </table>
            </div>
        </section>
    </main>

    <div id="infoModal" class="fixed inset-0 bg-black/60 hidden flex items-center justify-center p-6 z-50 backdrop-blur-sm">
        <div class="bg-white p-8 rounded-3xl max-w-lg w-full shadow-2xl border-t-8 border-blue-500">
            <h3 id="modalTitle" class="text-2xl font-black mb-4 text-blue-600">åŸç†å°å­¸å ‚</h3>
            <div id="modalContent" class="text-gray-700 leading-relaxed text-lg mb-8 space-y-2"></div>
            <button onclick="closeInfo()" class="w-full bg-blue-600 hover:bg-blue-700 text-white py-4 rounded-2xl font-black text-xl transition-transform active:scale-95">äº†è§£ï¼ç¹¼çºŒå¯¦é©—</button>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('simCanvas');
        const ctx = canvas.getContext('2d');
        const tableBody = document.getElementById('tableBody');
        const launchBtn = document.getElementById('launchBtn');
        const statusTag = document.getElementById('statusTag');
        
        // Match canvas to visual size
        function resizeCanvas() {
            canvas.width = canvas.clientWidth;
            canvas.height = canvas.clientHeight;
        }
        window.addEventListener('resize', resizeCanvas);
        resizeCanvas();

        let animationId;
        let history = JSON.parse(localStorage.getItem('rocketSimHistory_v2')) || [];

        function setupInputSync(slideId, inputId, updateFn) {
            const slide = document.getElementById(slideId);
            const input = document.getElementById(inputId);
            slide.oninput = () => { input.value = slide.value; updateFn(slide.value); };
            input.onchange = () => {
                let val = parseInt(input.value);
                if (val > slide.max) val = slide.max;
                if (val < slide.min) val = slide.min;
                input.value = val; slide.value = val; updateFn(val);
            };
        }

        setupInputSync('waterSlide', 'waterInput', val => {
            document.getElementById('waterPct').innerText = Math.round((val/500)*100);
        });
        setupInputSync('massSlide', 'massInput', () => {});
        setupInputSync('pressureSlide', 'pressureInput', () => {});
        setupInputSync('angleSlide', 'angleInput', () => {});

        function launch() {
            if (animationId) cancelAnimationFrame(animationId);
            statusTag.classList.remove('hidden');
            launchBtn.disabled = true;
            launchBtn.innerText = "ğŸš€ é£›è¡Œä¸­...";
            
            const water = parseFloat(document.getElementById('waterSlide').value);
            const dryMass = parseFloat(document.getElementById('massSlide').value);
            const pressure = parseFloat(document.getElementById('pressureSlide').value);
            const angleDeg = parseFloat(document.getElementById('angleSlide').value);
            const dragCoeff = parseFloat(document.getElementById('finShape').value);
            const finName = document.getElementById('finShape').options[document.getElementById('finShape').selectedIndex].text;

            let state = {
                x: 0, y: 0.1,
                vx: Math.cos(angleDeg * Math.PI / 180) * 0.1,
                vy: Math.sin(angleDeg * Math.PI / 180) * 0.1,
                waterLeft: water / 1000, 
                pressureCur: (pressure + 14.7) * 6894.76, 
                mass: (dryMass + water) / 1000,
                time: 0,
                path: []
            };

            const dt = 0.005; // Smaller time step for high-speed stability
            const nozzleArea = 0.000314; // Standard soda bottle opening
            const bottleVol = 0.001; // 1L total
            const airDensity = 1.225;
            const gravity = 9.81;

            function runPhysics() {
                // Sub-stepping loop (Run physics 10 times per frame for high pressure stability)
                for(let i=0; i<10; i++) {
                    let thrust = 0;
                    if (state.waterLeft > 0) {
                        const vExhaust = Math.sqrt(2 * (state.pressureCur - 101325) / 1000);
                        const massFlow = 1000 * nozzleArea * vExhaust;
                        thrust = massFlow * vExhaust;
                        
                        const actualExpelled = Math.min(state.waterLeft, massFlow * dt);
                        state.waterLeft -= actualExpelled;
                        state.mass -= actualExpelled;
                        
                        // Adiabatic expansion: P1V1 = P2V2 (approx)
                        const airVol = bottleVol - state.waterLeft;
                        state.pressureCur = state.pressureCur * Math.pow((airVol - nozzleArea * vExhaust * dt)/airVol, 1.4);
                    } else if (state.pressureCur > 101325) {
                        // Gas thrust phase (short)
                        thrust = (state.pressureCur - 101325) * nozzleArea * 0.5;
                        state.pressureCur *= 0.95;
                    }

                    const speed = Math.sqrt(state.vx**2 + state.vy**2);
                    const drag = 0.5 * airDensity * speed**2 * dragCoeff * 0.008;

                    const angle = Math.atan2(state.vy, state.vx);
                    const ax = (thrust * Math.cos(angle) - drag * Math.cos(angle)) / state.mass;
                    const ay = (thrust * Math.sin(angle) - state.mass * gravity - drag * Math.sin(angle)) / state.mass;

                    state.vx += ax * dt;
                    state.vy += ay * dt;
                    state.x += state.vx * dt;
                    state.y += state.vy * dt;
                    state.time += dt;

                    if (state.y <= 0 && state.time > 0.1) {
                        state.y = 0;
                        finishLaunch(state, {water, dryMass, pressure, angleDeg, finName});
                        return;
                    }
                }

                state.path.push({x: state.x, y: state.y});
                draw(state);
                animationId = requestAnimationFrame(runPhysics);
            }
            runPhysics();
        }

        function draw(state) {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            const scale = 8; // Zoom level
            const floorY = canvas.height - 40;
            const offsetX = state.x * scale > canvas.width * 0.4 ? (state.x * scale - canvas.width * 0.4) : 0;

            // Ground
            ctx.fillStyle = "#4ade80";
            ctx.fillRect(0, floorY, canvas.width, 40);
            
            // Markers
            ctx.fillStyle = "white";
            for(let i=0; i < state.x + 200; i+=5) {
                const mx = i * scale - offsetX;
                if (mx >= -50 && mx <= canvas.width + 50) {
                    ctx.fillRect(mx, floorY, 2, 8);
                    if(i % 10 === 0) {
                        ctx.font = "bold 12px Arial";
                        ctx.fillText(i + 'm', mx - 10, floorY + 22);
                    }
                }
            }

            // Trajectory
            ctx.beginPath();
            ctx.strokeStyle = "rgba(59, 130, 246, 0.4)";
            ctx.lineWidth = 3;
            state.path.forEach((p, i) => {
                const px = p.x * scale - offsetX;
                const py = floorY - p.y * scale;
                if(i === 0) ctx.moveTo(px, py); else ctx.lineTo(px, py);
            });
            ctx.stroke();

            // Rocket
            const rx = state.x * scale - offsetX;
            const ry = floorY - state.y * scale;
            ctx.save();
            ctx.translate(rx, ry);
            ctx.rotate(-Math.atan2(state.vy, state.vx));
            
            // Draw Bottle Shape
            ctx.fillStyle = "#f8fafc";
            ctx.strokeStyle = "#334155";
            ctx.lineWidth = 2;
            ctx.beginPath(); ctx.roundRect(-20, -7, 40, 14, 4); ctx.fill(); ctx.stroke();
            // Nose Cone
            ctx.fillStyle = "#ef4444";
            ctx.beginPath(); ctx.moveTo(20, -7); ctx.lineTo(35, 0); ctx.lineTo(20, 7); ctx.fill();
            
            ctx.restore();

            document.getElementById('hudHeight').innerText = Math.max(0, state.y).toFixed(1);
            document.getElementById('hudDist').innerText = state.x.toFixed(1);
        }

        function finishLaunch(state, inputs) {
            cancelAnimationFrame(animationId);
            statusTag.classList.add('hidden');
            launchBtn.disabled = false;
            launchBtn.innerText = "ğŸš€ å†æ¬¡ç™¼å°„ï¼";
            
            const distance = state.x.toFixed(2);
            const lastExp = history[0];
            let changes = 0;
            if(lastExp) {
                if(inputs.water != lastExp.water) changes++;
                if(inputs.dryMass != lastExp.dryMass) changes++;
                if(inputs.pressure != lastExp.pressure) changes++;
                if(inputs.angleDeg != lastExp.angleDeg) changes++;
                if(inputs.finName != lastExp.finName) changes++;
            }
            document.getElementById('fairTestBox').classList.toggle('hidden', changes <= 1 && history.length > 0);

            history.unshift({...inputs, distance, time: new Date().toLocaleTimeString()});
            localStorage.setItem('rocketSimHistory_v2', JSON.stringify(history));
            updateTable();
        }

        function updateTable() {
            tableBody.innerHTML = '';
            history.forEach((row, idx) => {
                const prev = history[idx + 1];
                const tr = document.createElement('tr');
                tr.className = "bg-white shadow-sm rounded-lg overflow-hidden";
                const check = (key) => prev && row[key] !== prev[key] ? 'highlight-change font-black text-blue-600' : '';
                
                tr.innerHTML = `
                    <td class="p-3 text-gray-400 font-bold">#${history.length - idx}</td>
                    <td class="p-3 ${check('water')}">${row.water}</td>
                    <td class="p-3 ${check('dryMass')}">${row.dryMass}</td>
                    <td class="p-3 ${check('pressure')}">${row.pressure}</td>
                    <td class="p-3 ${check('finName')}">${row.finName}</td>
                    <td class="p-3 ${check('angleDeg')}">${row.angleDeg}</td>
                    <td class="p-3 font-black text-red-500 bg-red-50 text-lg">${row.distance}</td>
                `;
                tableBody.appendChild(tr);
            });
        }

        function showInfo(key) {
            const data = {
                water: [
    "ğŸ’§ é—œæ–¼æ°´é‡ï¼šä½œç”¨åŠ›èˆ‡åä½œç”¨åŠ›", 
    `<b>ç§‘å­¸åŸç†ï¼šä½œç”¨åŠ›èˆ‡åä½œç”¨åŠ›</b><br>
    æ°´æ˜¯ç«ç®­çš„ã€ç‡ƒæ–™ã€ã€‚ç•¶æ°´ç«ç®­åº•éƒ¨çš„å£“åŠ›å°‡æ°´å‘å¾Œé«˜é€Ÿå™´å‡ºæ™‚ï¼ˆä½œç”¨åŠ›ï¼‰ï¼Œæ°´ä¹Ÿæœƒçµ¦äºˆç«ç®­ä¸€å€‹å‘å‰çš„æ¨å‹•åŠ›ï¼ˆåä½œç”¨åŠ›ï¼‰ã€‚<br><br>
    <b>ã€Œæ¨åŠ›ã€èˆ‡ã€Œé‡é‡ã€çš„æ‹‰é‹¸æˆ°ï¼š</b><br>
    <table class="w-full text-sm border-collapse border border-blue-200 mt-2">
        <tr class="bg-blue-100">
            <th class="border border-blue-200 p-1">æ°´é‡ç¨‹åº¦</th>
            <th class="border border-blue-200 p-1">å°ç«ç®­çš„å½±éŸ¿</th>
            <th class="border border-blue-200 p-1">é£›è¡Œçµæœ</th>
        </tr>
        <tr>
            <td class="border border-blue-200 p-1 font-bold">å¤ªå°‘æ°´</td>
            <td class="border border-blue-200 p-1">æ¨åŠ›æ™‚é–“å¤ªçŸ­ï¼Œèƒ½é‡å¾ˆå¿«ç”¨å®Œã€‚</td>
            <td class="border border-blue-200 p-1 text-red-500">é£›ä¸é  âŒ</td>
        </tr>
        <tr class="bg-green-50">
            <td class="border border-blue-200 p-1 font-bold text-green-700">é©ä¸­ (ç´„ 1/4 è‡³ 1/3)</td>
            <td class="border border-blue-200 p-1">å…¼é¡§æ¨å‹•åŠ›èˆ‡é©ç•¶é‡é‡ã€‚</td>
            <td class="border border-blue-200 p-1 text-green-600 font-bold">é£›æœ€é ã€æœ€é«˜ï¼ â­</td>
        </tr>
        <tr>
            <td class="border border-blue-200 p-1 font-bold">å¤ªå¤šæ°´</td>
            <td class="border border-blue-200 p-1">ç«ç®­è®Šå¤ªé‡ï¼Œä¸”å£“ç¸®ç©ºæ°£ç©ºé–“å¤ªå°ã€‚</td>
            <td class="border border-blue-200 p-1 text-orange-600">èµ·é£›æ²‰é‡ âš ï¸</td>
        </tr>
    </table>`
],
                mass: [
    "âš–ï¸ é—œæ–¼é‡é‡ï¼šç‰›é “ç¬¬äºŒå®šå¾‹",
    `<b>ç§‘å­¸åŸç†ï¼šåŠ é€Ÿåº¦èˆ‡æ…£æ€§</b><br>
    æ©Ÿèº«é‡é‡ï¼ˆä¸å«æ°´çš„é‡é‡ï¼‰ç›´æ¥å½±éŸ¿ç«ç®­èµ·é£›çš„é€Ÿåº¦èˆ‡é£›è¡Œçš„ç©©å®šæ€§ã€‚<br><br>
    <table class="w-full text-sm border-collapse border border-orange-200 mt-2">
        <tr class="bg-orange-100">
            <th class="border border-orange-200 p-1">é‡é‡æƒ…æ³</th>
            <th class="border border-orange-200 p-1">å°ç«ç®­çš„å½±éŸ¿</th>
            <th class="border border-orange-200 p-1">é£›è¡Œçµæœ</th>
        </tr>
        <tr>
            <td class="border border-orange-200 p-1 font-bold">å¤ªè¼•</td>
            <td class="border border-orange-200 p-1">èµ·é£›æ¥µå¿«ï¼Œä½†å› ç¼ºä¹æ…£æ€§ï¼Œæœƒè¢«ç©ºæ°£é˜»åŠ›è¿…é€Ÿæ¸›é€Ÿã€‚</td>
            <td class="border border-orange-200 p-1 text-orange-600">å¾Œå‹ä¸è¶³ï¼Œé£›ä¸é  âŒ</td>
        </tr>
        <tr class="bg-green-50">
            <td class="border border-orange-200 p-1 font-bold text-green-700">é©ä¸­</td>
            <td class="border border-orange-200 p-1">èµ·é£›é€Ÿåº¦å¿«ï¼Œä¸”æœ‰è¶³å¤ æ…£æ€§å°æŠ—é˜»åŠ›æ»‘ç¿”ã€‚</td>
            <td class="border border-orange-200 p-1 text-green-600 font-bold">é£›è¡Œç©©å®šä¸”æœ€é ï¼ â­</td>
        </tr>
        <tr>
            <td class="border border-orange-200 p-1 font-bold">å¤ªé‡</td>
            <td class="border border-orange-200 p-1">æ¨åŠ›é›£ä»¥å…‹æœå·¨å¤§çš„é‡åŠ›ï¼ˆF=maï¼‰ã€‚</td>
            <td class="border border-orange-200 p-1 text-red-500">èµ·é£›ç·©æ…¢ï¼Œå¾ˆå¿«å¢œåœ° âŒ</td>
        </tr>
    </table>`
],
                pressure: [
    "ğŸ’¨ é—œæ–¼æ°£å£“ï¼šèƒ½é‡çš„å„²å­˜",
    `<b>ç§‘å­¸åŸç†ï¼šå£“åŠ›èˆ‡èƒ½é‡è½‰æ›</b><br>
    æ°£å£“å°±åƒæ˜¯è¢«å£“ç¸®çš„å½ˆç°§ã€‚ç•¶ä½ æ‰“æ°£é€²å…¥ç“¶å­æ™‚ï¼Œå°±æ˜¯åœ¨å„²å­˜èƒ½é‡ã€‚å£“åŠ›è¶Šå¤§ï¼Œå™´æ°´çš„é€Ÿåº¦å°±è¶Šå¿«ï¼<br><br>
    <table class="w-full text-sm border-collapse border border-green-200 mt-2">
        <tr class="bg-green-100">
            <th class="border border-green-200 p-1">æ°£å£“é«˜ä½</th>
            <th class="border border-green-200 p-1">å°ç«ç®­çš„å½±éŸ¿</th>
            <th class="border border-green-200 p-1">é£›è¡Œçµæœ</th>
        </tr>
        <tr>
            <td class="border border-green-200 p-1 font-bold text-blue-600">ä½æ°£å£“</td>
            <td class="border border-green-200 p-1">èƒ½é‡ä¸è¶³ï¼Œæ°´å™´å‡ºçš„é€Ÿåº¦éå¸¸ç·©æ…¢ã€‚</td>
            <td class="border border-green-200 p-1 text-orange-600">å‹•åŠ›å¾®å¼±ï¼Œé£›ä¸é«˜ âŒ</td>
        </tr>
        <tr class="bg-green-50">
            <td class="border border-green-200 p-1 font-bold text-green-700">é«˜æ°£å£“ (60psi)</td>
            <td class="border border-green-200 p-1">å„²å­˜å¤§é‡èƒ½é‡ï¼Œç¬é–“å™´å°„åŠ›æ¥µå¼·ã€‚</td>
            <td class="border border-green-200 p-1 text-green-600 font-bold">çˆ†ç™¼åŠ›å¼·ï¼Œé£›æœ€é ï¼ â­</td>
        </tr>
        <tr>
            <td class="border border-green-200 p-1 font-bold text-red-600">éåº¦æ°£å£“</td>
            <td class="border border-green-200 p-1">è¶…éç“¶å­èƒ½æ‰¿å—çš„æ¥µé™ã€‚</td>
            <td class="border border-green-200 p-1 text-red-600 font-bold">ç“¶èº«çˆ†è£‚ï¼Œéå¸¸å±éšªï¼ âš ï¸</td>
        </tr>
    </table>`
],
                angle: [
    "ğŸ“ é—œæ–¼ç™¼å°„è§’åº¦ï¼šæ‹‹ç‰©ç·šèˆ‡å°„ç¨‹",
    `<b>ç§‘å­¸åŸç†ï¼šæ‹‹ç‰©ç·šé‹å‹•</b><br>
    ç™¼å°„è§’åº¦æ±ºå®šäº†ç«ç®­åœ¨ç©ºä¸­åœç•™çš„æ™‚é–“èˆ‡å‰é€²çš„è·é›¢ã€‚æƒ³åƒä½ åœ¨æŠ•ç±ƒï¼Œå¤ªé«˜æˆ–å¤ªä½éƒ½æŠ•ä¸é ã€‚<br><br>
    <table class="w-full text-sm border-collapse border border-purple-200 mt-2">
        <tr class="bg-purple-100">
            <th class="border border-purple-200 p-1">ç™¼å°„è§’åº¦</th>
            <th class="border border-purple-200 p-1">å°ç«ç®­çš„å½±éŸ¿</th>
            <th class="border border-purple-200 p-1">é£›è¡Œçµæœ</th>
        </tr>
        <tr>
            <td class="border border-purple-200 p-1 font-bold">ä½è§’åº¦ (0-30Â°)</td>
            <td class="border border-purple-200 p-1">ç«ç®­å¤ªè²¼è¿‘åœ°é¢ï¼Œå—é‡åŠ›å½±éŸ¿å¾ˆå¿«å¢œæ¯€ã€‚</td>
            <td class="border border-purple-200 p-1 text-orange-600">å¾ˆå¿«è½åœ°ï¼Œè·é›¢çŸ­ âŒ</td>
        </tr>
        <tr class="bg-green-50">
            <td class="border border-purple-200 p-1 font-bold text-green-700">é»ƒé‡‘è§’åº¦ (45-55Â°)</td>
            <td class="border border-purple-200 p-1">å®Œç¾å¹³è¡¡é«˜åº¦èˆ‡å‰é€²é€Ÿåº¦ï¼Œé£›è¡Œè»Œè·¡æœ€å„ªã€‚</td>
            <td class="border border-purple-200 p-1 text-green-600 font-bold">é£›å¾—æœ€é ï¼ â­</td>
        </tr>
        <tr>
            <td class="border border-purple-200 p-1 font-bold">é«˜è§’åº¦ (60-90Â°)</td>
            <td class="border border-purple-200 p-1">èƒ½é‡éƒ½èŠ±åœ¨å¾€ä¸Šé£›ï¼Œé›–ç„¶é£›å¾ˆé«˜ä½†æ²’åœ¨å‰é€²ã€‚</td>
            <td class="border border-purple-200 p-1 text-blue-600">é£›å¾—å¾ˆé«˜ï¼Œä½†è½åœ°è¿‘ âŒ</td>
        </tr>
    </table>`
],
                fins: [
    "ğŸ¦ˆ é—œæ–¼å°¾ç¿¼ï¼šç©©å®šæ€§èˆ‡ç©ºæ°£é˜»åŠ›",
    `<b>ç§‘å­¸åŸç†ï¼šç©ºæ°£å‹•åŠ›å­¸</b><br>
    å°¾ç¿¼å°±åƒé­šçš„é°­æˆ–ç®­çš„ç¾½æ¯›ï¼Œèƒ½è®“ç«ç®­åœ¨é«˜é€Ÿé£›è¡Œæ™‚ä¿æŒå¹³è¡¡ï¼Œä¸äº‚ç¿»æ»¾ã€‚ä¸åŒçš„å½¢ç‹€æœƒç”¢ç”Ÿä¸åŒçš„é˜»åŠ›ï¼ˆDragï¼‰ã€‚<br><br>
    <table class="w-full text-sm border-collapse border border-slate-200 mt-2">
        <tr class="bg-slate-200">
            <th class="border border-slate-300 p-1">å°¾ç¿¼å½¢ç‹€</th>
            <th class="border border-slate-300 p-1">ç©ºæ°£é˜»åŠ›</th>
            <th class="border border-slate-300 p-1">é£›è¡Œç‰¹é»</th>
        </tr>
        <tr>
            <td class="border border-slate-200 p-1 font-bold">æ–¹å½¢ / åœ“å½¢ç¿¼</td>
            <td class="border border-slate-200 p-1 text-orange-600 font-bold">è¼ƒå¤§</td>
            <td class="border border-slate-200 p-1">ç©©å®šæ€§å¥½ï¼Œä½†å› ç‚ºé˜»åŠ›å¤§ï¼Œæœƒæ¸›æ…¢é€Ÿåº¦ã€‚</td>
        </tr>
        <tr class="bg-slate-50">
            <td class="border border-slate-200 p-1 font-bold">ä¸‰è§’å½¢ / æ¢¯å½¢ç¿¼</td>
            <td class="border border-slate-200 p-1 text-blue-600 font-bold">ä¸­ç­‰</td>
            <td class="border border-slate-200 p-1">æœ€å¸¸è¦‹çš„è¨­è¨ˆï¼Œå…¼é¡§ç©©å®šèˆ‡é€Ÿåº¦ã€‚</td>
        </tr>
        <tr class="bg-green-50">
            <td class="border border-slate-200 p-1 font-bold text-green-700">é­šé°­ / å¾Œæ ç¿¼</td>
            <td class="border border-slate-200 p-1 text-green-600 font-bold">æœ€å° â­</td>
            <td class="border border-slate-200 p-1">æ¨¡ä»¿è¶…éŸ³é€Ÿé£›æ©Ÿï¼Œåˆ‡å‰²ç©ºæ°£èƒ½åŠ›æœ€å¼·ï¼Œé£›æœ€å¿«ï¼</td>
        </tr>
    </table>`
],
            };
            document.getElementById('modalTitle').innerText = data[key][0];
            document.getElementById('modalContent').innerHTML = `<p>${data[key][1]}</p>`;
            document.getElementById('infoModal').classList.remove('hidden');
        }

        function closeInfo() { document.getElementById('infoModal').classList.add('hidden'); }

        function copyTableData() {
            let text = "æ¬¡æ•¸,æ°´é‡,é‡é‡,æ°£å£“,å°¾ç¿¼,è§’åº¦,è·é›¢\n";
            history.forEach((r, i) => text += `${history.length-i},${r.water},${r.dryMass},${r.pressure},${r.finName},${r.angleDeg},${r.distance}\n`);
            navigator.clipboard.writeText(text).then(() => alert("æ•¸æ“šå·²è¤‡è£½åˆ°å‰ªè²¼ç°¿ï¼ˆCSVæ ¼å¼ï¼‰"));
        }

        function exportTableImage() {
            html2canvas(document.getElementById('recordTable')).then(canvas => {
                const link = document.createElement('a');
                link.download = 'å¯¦é©—ç´€éŒ„.png';
                link.href = canvas.toDataURL();
                link.click();
            });
        }

        function clearHistory() {
            if(confirm("ç¢ºå®šè¦åˆªé™¤æ‰€æœ‰ç´€éŒ„å—ï¼Ÿ")) { history = []; updateTable(); }
        }

        launchBtn.onclick = launch;
        updateTable();
    </script>
</body>
</html>
